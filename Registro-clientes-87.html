<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de Clientes - 87 Autos</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/theme.css">
</head>
<body class="app-body">
  <div class="layout layout--centered">
    <section class="card layout__panel">
      <form id="registroForm" class="form stack stack--lg" novalidate>
        <div class="form-header">
          <img src="imagenes/MEMBRETE_HEADER.png" alt="Membrete corporativo 87 Autos" class="brand-banner" loading="lazy">
          <div class="stack">
            <h1 class="card-title">Registro de Oportunidad</h1>
            <p class="card-subtitle">Completa la informaci√≥n de la visita para que el equipo haga seguimiento oportuno.</p>
          </div>
          <button type="button" class="button button--outline button--icon" id="open-search">
            üîç Buscar Cliente
          </button>
        </div>

        <div class="form-group">
          <label for="fechaHora" class="form-label">Fecha y Hora</label>
          <input type="datetime-local" id="fechaHora" name="fechaHora" class="form-control" required>
        </div>

        <div class="form-group">
          <label for="sede" class="form-label">Sede</label>
          <div class="select-wrapper">
            <select id="sede" name="sede" class="form-control" required>
              <option value="" disabled selected>Seleccione una sede</option>
              <option value="Calleja">Calleja</option>
              <option value="San patricio">San Patricio</option>
              <option value="Santa Barbara">Santa B√°rbara</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="asesor" class="form-label">Nombre Asesor</label>
          <div class="select-wrapper">
            <select id="asesor" name="asesor" class="form-control" required>
              <option value="" disabled selected>Seleccione un asesor</option>
              <option value="Jhon Abril">Jhon Abril</option>
              <option value="Marco Loaiza">Marco Loaiza</option>
              <option value="Juan Sebasti√°n Ortega">Juan Sebasti√°n Ortega</option>
              <option value="Yulieth Serrano">Yulieth Serrano</option>
              <option value="Juan Diego Duarte">Juan Diego Duarte</option>
              <option value="Jorge Rodr√≠guez">Jorge Rodr√≠guez</option>
              <option value="Juan Manuel Rodr√≠guez">Juan Manuel Rodr√≠guez</option>
              <option value="Mart√≠n Santamar√≠a">Mart√≠n Santamar√≠a</option>
              <option value="Juan Esteban Vargas">Juan Esteban Vargas</option>
              <option value="Duber Bernal">Duber Bernal</option>
              <option value="Juan Esteban Rodriguez">Juan Esteban Rodriguez</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="fuente" class="form-label">Fuente</label>
          <div class="select-wrapper">
            <select id="fuente" name="fuente" class="form-control" required>
              <option value="" disabled selected>Seleccione una fuente</option>
              <option value="Trafico">Tr√°fico</option>
              <option value="Asesor">Asesor</option>
              <option value="Escala">Escala</option>
              <option value="Consignaci√≥n JP">Consignaci√≥n JP</option>
              <option value="Redes Sociales">Redes Sociales</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="clienteNombre" class="form-label">Nombre Cliente</label>
          <input type="text" id="clienteNombre" name="clienteNombre" class="form-control" required>
        </div>

        <div class="form-group">
          <label for="clienteTelefono" class="form-label">N√∫mero telef√≥nico</label>
          <input type="tel" id="clienteTelefono" name="clienteTelefono" class="form-control" required inputmode="tel" autocomplete="tel" placeholder="+57 3123456789" pattern="^[+0-9 ()-]+$" title="Permite prefijos internacionales como +57, +52, etc.">
        </div>

        <div class="form-group">
          <label for="clienteCedula" class="form-label">C√©dula</label>
          <input type="text" id="clienteCedula" name="clienteCedula" class="form-control">
        </div>

        <div class="form-group">
          <label for="necesidad" class="form-label">Necesidad Principal</label>
          <div class="select-wrapper">
            <select id="necesidad" name="necesidad" class="form-control" required>
              <option value="" disabled selected>Seleccione una necesidad</option>
              <option value="Compra">Compra</option>
              <option value="Vende">Vende</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="tipoVehiculo" class="form-label">Busca / Vende</label>
          <div class="select-wrapper">
            <select id="tipoVehiculo" name="tipoVehiculo" class="form-control" required>
              <option value="" disabled selected>Seleccione un tipo</option>
              <option value="Carro">Carro</option>
              <option value="Camioneta">Camioneta</option>
              <option value="Moto">Moto</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="anioModeloVehiculo" class="form-label">A√±o modelo del veh√≠culo</label>
          <input
            type="number"
            id="anioModeloVehiculo"
            name="anioModeloVehiculo"
            class="form-control"
            min="1950"
            max="2100"
            step="1"
            placeholder="Ej. 2024">
        </div>

        <div class="form-group">
          <label for="marcaVehiculo" class="form-label">Marca del veh√≠culo</label>
          <div class="select-wrapper">
            <select id="marcaVehiculo" name="marcaVehiculo" class="form-control">
              <option value="" disabled selected>Seleccione una marca</option>
            </select>
          </div>
        </div>

        <div class="form-group hidden" id="serieVehiculoGroup">
          <label for="serieVehiculoSelect" class="form-label">Serie del veh√≠culo</label>
          <div class="select-wrapper">
            <select id="serieVehiculoSelect" name="serieVehiculoSelect" class="form-control" disabled>
              <option value="" disabled selected>Seleccione una serie</option>
            </select>
          </div>
        </div>

        <div class="form-group hidden" id="modeloVehiculoGroup">
          <label for="modeloVehiculoSelect" class="form-label">Modelo espec√≠fico</label>
          <div class="select-wrapper">
            <select id="modeloVehiculoSelect" name="modeloVehiculoSelect" class="form-control" disabled>
              <option value="" disabled selected>Seleccione un modelo</option>
            </select>
          </div>
          <input type="text" id="modeloVehiculoCustom" name="modeloVehiculoCustom" class="form-control hidden" placeholder="Especifica el modelo...">
        </div>

        <div class="form-group hidden" id="serieVehiculoManualGroup">
          <label for="serieVehiculoManual" class="form-label">Serie del veh√≠culo</label>
          <input type="text" id="serieVehiculoManual" name="serieVehiculoManual" class="form-control" placeholder="Especifica la serie y modelo...">
        </div>

        <div class="form-group">
          <button type="button" id="addVehiculoButton" class="button button--primary" disabled>Agregar selecci√≥n</button>
        </div>

        <div class="form-group">
          <label class="form-label" for="selectedVehiculosContainer">Veh√≠culos seleccionados</label>
          <div id="selectedVehiculosContainer" class="vehicle-summary" aria-live="polite">Sin veh√≠culos seleccionados.</div>
        </div>

        <input type="hidden" id="serieVehiculo" name="serieVehiculo">

        <div class="form-group">
          <label for="presupuesto" class="form-label">Presupuesto</label>
          <input type="number" id="presupuesto" name="presupuesto" class="form-control">
        </div>

        <div class="form-group">
          <label for="siguientePaso" class="form-label">Siguiente paso</label>
          <div class="select-wrapper">
            <select id="siguientePaso" name="siguientePaso" class="form-control" required>
              <option value="" disabled selected>Seleccione una opci√≥n</option>
              <option value="interesado">Interesado</option>
              <option value="no_interesado">No interesado</option>
              <option value="seguimiento">Seguimiento</option>
              <option value="llamada">Llamada</option>
              <option value="agendamiento">Agendamiento</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="observaciones" class="form-label">Observaciones</label>
          <textarea id="observaciones" name="observaciones" class="form-control" rows="4"></textarea>
        </div>

        <button type="submit" id="submit-button" class="button button--accent button--full">Enviar registro</button>
      </form>
    </section>
  </div>

  <div id="success-modal" class="modal-overlay" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <p id="modal-title" class="modal-title">Registro enviado</p>
      <button type="button" id="close-modal" class="button button--primary button--full">Entendido</button>
    </div>
  </div>

  <script src="app-config.js"></script>
  <script>
    const { webAppUrl = '' } = window.APP_CONFIG || {};
    const scriptURL = webAppUrl.trim();
    const form = document.getElementById('registroForm');
    const submitButton = document.getElementById('submit-button');
    const successModal = document.getElementById('success-modal');
    const closeModalButton = document.getElementById('close-modal');
    const tipoVehiculoSelect = document.getElementById('tipoVehiculo');
    const vehicleBrandSelect = document.getElementById('marcaVehiculo');
    const vehicleSeriesGroup = document.getElementById('serieVehiculoGroup');
    const vehicleSeriesSelect = document.getElementById('serieVehiculoSelect');
    const vehicleModelGroup = document.getElementById('modeloVehiculoGroup');
    const vehicleModelSelect = document.getElementById('modeloVehiculoSelect');
    const vehicleModelCustomInput = document.getElementById('modeloVehiculoCustom');
    const vehicleManualGroup = document.getElementById('serieVehiculoManualGroup');
    const vehicleManualInput = document.getElementById('serieVehiculoManual');
    const serieVehiculoHiddenInput = document.getElementById('serieVehiculo');
    const addVehicleButton = document.getElementById('addVehiculoButton');
    const selectedVehiclesContainer = document.getElementById('selectedVehiculosContainer');
    const openSearchButton = document.getElementById('open-search');

    const MANUAL_OPTION_VALUE = '__manual__';
    const OTHER_MODEL_VALUE = '__other_model__';

    let selectedVehicles = [];

    if (openSearchButton) {
      openSearchButton.addEventListener('click', () => {
        window.location.href = 'consulta-clientes.html';
      });
    }

        const VEHICLE_CATALOG = {
            bmwAutos: {
                nombre: 'BMW',
                tipo: 'Carro',
                series: {
                    serie_1: {
                        nombre: 'Serie 1',
                        modelos: [
                            '114i - hatchback',
                            '116i - hatchback',
                            '118 - hatchback',
                            '118d - hatchback',
                            '118i - hatchback',
                            '120d - hatchback',
                            '120i - descapotables',
                            '120i - hatchback',
                            '120i - sedan',
                            '125i - sedan',
                            '128i - descapotables',
                            '128ti - hatchback',
                            '130i - hatchback',
                            '135i - descapotables',
                            '135i - sedan'
                        ]
                    },
                    serie_2: {
                        nombre: 'Serie 2',
                        modelos: [
                            '218 - sedan',
                            '218i - hatchback',
                            '218i - sedan',
                            '218i - van pasajeros',
                            '220i - descapotables',
                            '220i - sedan',
                            '225xe - hatchback'
                        ]
                    },
                    serie_3: {
                        nombre: 'Serie 3',
                        modelos: [
                            '316 - sedan',
                            '316i - hatchback',
                            '316i - sedan',
                            '318ci - sedan',
                            '318i - descapotables',
                            '318i - sedan',
                            '318ia - descapotables',
                            '318is - sedan',
                            '318ti - hatchback',
                            '320/4 - sedan',
                            '320/6 - sedan',
                            '320d - sedan',
                            '320i - descapotables',
                            '320i - facelift - sedan',
                            '320i - hatchback',
                            '320i - sedan',
                            '320i - station wagon',
                            '320ia - sedan',
                            '323i - sedan',
                            '323tia - hatchback',
                            '325ci - descapotables',
                            '325ci - sedan',
                            '325e - sedan',
                            '325i - descapotables',
                            '325i - sedan',
                            '325i - station wagon',
                            '325is - sedan',
                            '325ti - hatchback',
                            '328ci - sedan',
                            '328i - descapotables',
                            '328i - sedan',
                            '328i - station wagon',
                            '330ci - descapotables',
                            '330ci - sedan',
                            '330e - sedan',
                            '330i - descapotables',
                            '330i - hatchback',
                            '330i - sedan',
                            '330i - station wagon',
                            '330xi - sedan',
                            '335i - descapotables',
                            '335i - sedan',
                            '340i - sedan'
                        ]
                    },
                    serie_4: {
                        nombre: 'Serie 4',
                        modelos: [
                            '418i - hatchback',
                            '420i - descapotables',
                            '420i - hatchback',
                            '420i - sedan',
                            '428i - descapotables',
                            '428i - hatchback',
                            '428i - sedan',
                            '430i - descapotables',
                            '430i - hatchback',
                            '430i - sedan',
                            '435i - descapotables',
                            '435i - hatchback',
                            '435i - sedan',
                            '440i - descapotables',
                            '440i - sedan'
                        ]
                    },
                    serie_5: {
                        nombre: 'Serie 5',
                        modelos: [
                            '518 - sedan',
                            '518i - sedan',
                            '520 - sedan',
                            '520d - sedan',
                            '520i - sedan',
                            '523i - sedan',
                            '523ia - sedan',
                            '525 - sedan',
                            '525i - sedan',
                            '525i - station wagon',
                            '525xi - sedan',
                            '528 - sedan',
                            '528i - sedan',
                            '528ia - sedan',
                            '528ia - station wagon',
                            '530d - sedan',
                            '530e - sedan',
                            '530i - sedan',
                            '530i - station wagon',
                            '530ia - station wagon',
                            '535i - hatchback',
                            '535i - sedan',
                            '540i - sedan',
                            '540i - station wagon',
                            '540ia - sedan',
                            '545i - sedan',
                            '550i - hatchback',
                            '550i - sedan'
                        ]
                    },
                    serie_6: {
                        nombre: 'Serie 6',
                        modelos: [
                            '628csi - sedan',
                            '630i - descapotables',
                            '630i - sedan',
                            '635csi - sedan',
                            '640i - descapotables',
                            '640i - sedan',
                            '645ci - sedan',
                            '650i - descapotables',
                            '650i - sedan'
                        ]
                    },
                    serie_7: {
                        nombre: 'Serie 7',
                        modelos: [
                            '728i - sedan',
                            '730 - sedan',
                            '730d - sedan',
                            '730i - sedan',
                            '730ial - sedan',
                            '733i - sedan',
                            '735i - sedan',
                            '735il - sedan',
                            '740i - sedan',
                            '740il - sedan',
                            '745e - sedan',
                            '745i - sedan',
                            '750i - sedan',
                            '750il - sedan',
                            '750li - sedan',
                            '760li - sedan'
                        ]
                    },
                    serie_8: {
                        nombre: 'Serie 8',
                        modelos: [
                            '850ci - sedan'
                        ]
                    },
                    clasicos: {
                        nombre: 'Cl√°sicos',
                        modelos: [
                            '2002 - sedan'
                        ]
                    },
                    serie_i: {
                        nombre: 'Serie i (el√©ctricos)',
                        modelos: [
                            'I3 - hatchback',
                            'I3s - hatchback',
                            'I4 - sedan',
                            'I5 - sedan',
                            'I7 - sedan',
                            'I8 - hatchback',
                            'Ix - utilitario deportivo 4x4',
                            'Ix1 - station wagon',
                            'Ix1 - utilitario deportivo 4x2',
                            'Ix1 - utilitario deportivo 4x4',
                            'Ix2 - utilitario deportivo 4x4',
                            'Ix3 - utilitario deportivo 4x2',
                            'Ix3 - utilitario deportivo 4x4'
                        ]
                    },
                    serie_m: {
                        nombre: 'Serie M',
                        modelos: [
                            'M - sedan',
                            'M2 - sedan',
                            'M3 - descapotables',
                            'M3 - sedan',
                            'M4 - descapotables',
                            'M4 - sedan',
                            'M5 - sedan',
                            'M6 - descapotables',
                            'M6 - sedan',
                            'M8 - sedan',
                            'M135 - hatchback',
                            'M135i - hatchback',
                            'M140i - hatchback',
                            'M235i - descapotables',
                            'M235i - sedan',
                            'M240i - descapotables',
                            'M240i - sedan',
                            'M340i - sedan',
                            'M440i - descapotables',
                            'M440i - sedan',
                            'M535i - sedan',
                            'M550i - sedan',
                            'M850i - descapotables',
                            'M850i - sedan'
                        ]
                    },
                    serie_x: {
                        nombre: 'Serie X (SUVs)',
                        modelos: [
                            'X1 - generaci√≥n 2 - utilitario deportivo 4x4',
                            'X1 - generaci√≥n 3 - utilitario deportivo 4x2',
                            'X1 - station wagon',
                            'X1 - utilitario deportivo 4x2',
                            'X1 - utilitario deportivo 4x4',
                            'X2 - generaci√≥n 2 - utilitario deportivo 4x4',
                            'X2 - utilitario deportivo 4x2',
                            'X2 - utilitario deportivo 4x4',
                            'X3 - station wagon',
                            'X3 - utilitario deportivo 4x2',
                            'X3 - utilitario deportivo 4x4',
                            'X4 - station wagon',
                            'X4 - utilitario deportivo 4x4',
                            'X5 - facelift - utilitario deportivo 4x4',
                            'X5 - station wagon',
                            'X5 - utilitario deportivo 4x4',
                            'X6 - station wagon',
                            'X6 - utilitario deportivo 4x4',
                            'X7 - utilitario deportivo 4x4',
                            'Xm - station wagon'
                        ]
                    },
                    serie_z: {
                        nombre: 'Serie Z (Roadsters)',
                        modelos: [
                            'Z3 - descapotables',
                            'Z4 - descapotables',
                            'Z4 - hatchback'
                        ]
                    }
                }
            },
            bmwMotorrad: {
                nombre: 'BMW Motorrad',
                tipo: 'Moto',
                series: {
                    serie_c_scooters: {
                        nombre: 'Serie C (Scooters)',
                        modelos: [
                            'BMW C 600 Sport AT 650CC',
                            'BMW C 650 GT AT 650CC',
                            'BMW C 650 Sport AT 650CC',
                            'BMW C 400 X AT 350CC ABS',
                            'BMW C 400 GT AT 350CC ABS'
                        ]
                    },
                    serie_ce_scooters_el_ctricos: {
                        nombre: 'Serie CE (Scooters el√©ctricos)',
                        modelos: [
                            'BMW CE 04 Avantgarde/White AT ABS',
                            'BMW CE 02 Basic AT ABS',
                            'BMW CE 02 Highline AT ABS'
                        ]
                    },
                    serie_c1: {
                        nombre: 'Serie C1',
                        modelos: [
                            'BMW C1 200 AT 200CC'
                        ]
                    },
                    serie_f: {
                        nombre: 'Serie F',
                        modelos: [
                            'BMW F 650 GS Dakar MT 650CC',
                            'BMW F 650 GS MT 650CC',
                            'BMW F 650 S/ST MT 650CC',
                            'BMW F 650 GS Twin MT 800CC',
                            'BMW F 700 GS MT 800CC',
                            'BMW F 750 GS Premium MT 850CC ABS',
                            'BMW F 750 GS Comfort MT 850CC ABS',
                            'BMW F 750 GS Essential MT 850CC ABS',
                            'BMW F 800 GS MT 800CC',
                            'BMW F 800 GS Adventure MT 800CC',
                            'BMW F 800 [K80] GS MT 900CC ABS',
                            'BMW F 800 S MT 800CC',
                            'BMW F 800 R MT 800CC',
                            'BMW F 800 GT MT 800CC',
                            'BMW F 800 R [FL] MT 800CC',
                            'BMW F 850 [K81] GS Premium MT 850CC ABS',
                            'BMW F 850 [K82] GS Adventure MT 850CC ABS',
                            'BMW F 850 [K81] GS Comfort MT 850CC ABS',
                            'BMW F 900 GS-P MT 900CC ABS',
                            'BMW F 900 R Dynamic MT 900CC ABS',
                            'BMW F 900 XR Dynamic MT 900CC ABS',
                            'BMW F 900 R Pure MT 900CC ABS',
                            'BMW F 900 GS MT 900CC ABS',
                            'BMW F 900 GS Adventure Premium/HP MT 900CC ABS',
                            'BMW F 900 GS Comfort MT 900CC ABS'
                        ]
                    },
                    serie_g: {
                        nombre: 'Serie G',
                        modelos: [
                            'BMW G 310 [K02] GS MT 310CC ABS',
                            'BMW G 310 [K03] R MT 310CC ABS',
                            'BMW G 450 X MT 450CC',
                            'BMW G 650 Xmoto MT 650CC',
                            'BMW G 650 GS [180] MT 650CC',
                            'BMW G 650 GS Sertao MT 650CC',
                            'BMW G 650 GS [188] MT 650CC'
                        ]
                    },
                    serie_hp: {
                        nombre: 'Serie HP',
                        modelos: [
                            'BMW HP2 Enduro MT 1200CC',
                            'BMW HP4 Sport MT 1000CC'
                        ]
                    },
                    serie_k: {
                        nombre: 'Serie K',
                        modelos: [
                            'BMW K 75S MT 750CC',
                            'BMW K 1200S MT 1200CC',
                            'BMW K 1200LT MT 1200CC',
                            'BMW K 1300S MT 1300CC',
                            'BMW K 1600GT MT 1600CC',
                            'BMW K 1200R MT 1200CC',
                            'BMW K 1300R MT 1300CC',
                            'BMW K 1600GTL MT 1600CC',
                            'BMW K 1600GTL Exclusive MT 1600CC',
                            'BMW K 1600B MT 1600CC'
                        ]
                    },
                    serie_m: {
                        nombre: 'Serie M',
                        modelos: [
                            'BMW M 1000 RR M MT 1000CC',
                            'BMW M 1000 XR MT 1000CC ABS',
                            'BMW M [FL] 1000 RR MT 1000CC ABS'
                        ]
                    },
                    serie_r: {
                        nombre: 'Serie R',
                        modelos: [
                            'BMW R 1100 GS MT 1100CC',
                            'BMW R 1150 GS MT 1150CC',
                            'BMW R 1150 GS Adventure MT 1150CC',
                            'BMW R [K25] 1200 GS MT 1200CC',
                            'BMW R [K25] 1200 GS Adventure MT 1200CC',
                            'BMW R [K50] 1200 GS MT 1200CC',
                            'BMW R [K51] 1200 GS Adventure MT 1200CC',
                            'BMW R [K50] 1250 GS MT 1250CC ABS',
                            'BMW R [K51] 1250 GS Adventure P MT 1250CC ABS',
                            'BMW R [K51] 1250 GS Adventure R MT 1250CC ABS',
                            'BMW R 1300 GS Premium/Pro MT 1300CC ABS',
                            'BMW R 1300 GS Tramuntana MT 1300CC ABS',
                            'BMW R 850 R MT 850CC',
                            'BMW R 1150 R MT 1150CC',
                            'BMW R [K27] 1200 R MT 1200CC',
                            'BMW R 1200 C MT 1200CC',
                            'BMW R [K21] nineT MT 1200CC',
                            'BMW R [K53] 1200 R MT 1200CC ABS',
                            'BMW R [K23] nineT Scrambler MT 1200CC ABS',
                            'BMW R [K33] nineT Urban G/S MT 1200CC ABS',
                            'BMW R [K22] nineT Pure MT 1200CC ABS',
                            'BMW R 100/7T MT 980CC',
                            'BMW R [K53] 1250 R MT 1250CC ABS',
                            'BMW R [K52] 1250 RT MT 1250CC ABS',
                            'BMW R 18/Rocktane MT 1800CC ABS',
                            'BMW R [K33] nineT Urban GS Edici√≥n 40 a√±os MT 1200CC ABS',
                            'BMW R [K52] [FL] 1250 RT MT 1250CC ABS',
                            'BMW R 12 MT 1200CC ABS',
                            'BMW R [KR1] 12 nineT Premium MT 1200CC ABS',
                            'BMW R 18 Transcontinental MT 1800CC ABS',
                            'BMW R 18 Bagger MT 1800CC ABS',
                            'BMW R 1100GS MT 1100CC',
                            'BMW R 1150GS MT 1150CC',
                            'BMW R 1150GS Adventure MT 1150CC',
                            'BMW R 1200GS [K25] MT 1200CC',
                            'BMW R 1200GS Adventure [K25] MT 1200CC',
                            'BMW R 1200GS [K50] MT 1200CC',
                            'BMW R 1200GS Adventure [K51] MT 1200CC',
                            'BMW R 1250GS [K50] MT 1250CC ABS',
                            'BMW R 1250GS Adventure P [K51] MT 1250CC ABS',
                            'BMW R 1250GS Adventure R [K51] MT 1250CC ABS',
                            'BMW R 1300GS Adventure Premium Red/Auto MT 1300CC ABS',
                            'BMW R 1300GS Adventure Premium Trophy/Black-Karakoum MT 1300CC ABS',
                            'BMW R 850R MT 850CC',
                            'BMW R 1150R MT 1150CC',
                            'BMW R 1200R [K27] MT 1200CC',
                            'BMW R 1200C MT 1200CC',
                            'BMW R nineT [K21] MT 1200CC',
                            'BMW R 1200R [K53] MT 1200CC ABS',
                            'BMW R nineT Scrambler [K23] MT 1200CC ABS',
                            'BMW R nineT Urban G/S [K33] MT 1200CC ABS',
                            'BMW R nineT Pure [K22] MT 1200CC ABS',
                            'BMW R 1250R [K53] MT 1250CC ABS',
                            'BMW R 1250RT [K52] MT 1250CC ABS',
                            'BMW R 18 Roctane MT 1800CC ABS',
                            'BMW R nineT Urban G/S 40 a√±os [K33] MT 1200CC ABS',
                            'BMW R 1250RT [K52 FL] MT 1250CC ABS',
                            'BMW R 12 nineT Premium [KR1] MT 1200CC ABS',
                            'BMW R 1100S MT 1100CC',
                            'BMW R 1200ST MT 1200CC',
                            'BMW R 1200RT MT 1200CC',
                            'BMW R 1200RT [K52] MT 1200CC',
                            'BMW R 1200RS [K54] MT 1200CC ABS'
                        ]
                    },
                    serie_s: {
                        nombre: 'Serie S',
                        modelos: [
                            'BMW S 1000RR [K46] MT 1000CC',
                            'BMW S 1000RR M [K67] MT 1000CC',
                            'BMW S 1000RR MS Carbon [K67] MT 1000CC ABS',
                            'BMW S 1000RR Dynamic [K67] MT 1000CC ABS',
                            'BMW S 1000RR Dynamic HP MT 1000CC',
                            'BMW S 1000RR Motorsport HP MT 1000CC',
                            'BMW S 1000RR MS HP Carbon MT 1000CC ABS',
                            'BMW S 1000R Dynamic [FL] MT 1000CC ABS',
                            'BMW S 1000R MS HP [FL] MT 1000CC ABS',
                            'BMW S 1000XR Motorsport MT 1000CC ABS',
                            'BMW S 1000R [K47] MT 1000CC',
                            'BMW S 1000XR Dynamic MT 1000CC',
                            'BMW S 1000R [K47 FL] MT 1000CC',
                            'BMW S 1000R M [K63] MT 1000CC',
                            'BMW S 1000R Dynamic MT 1000CC'
                        ]
                    }
                }
            },
            mini: {
                nombre: 'MINI',
                tipo: 'Carro',
                series: {
                    mini_aceman_hatchback: {
                        nombre: 'MINI Aceman ‚Äì hatchback',
                        modelos: [
                            'MINI Aceman SE Favoured AT 163KW 6AB',
                            'MINI Aceman E Classic AT 137KW 6AB'
                        ]
                    },
                    mini_clubman_hatchback: {
                        nombre: 'MINI Clubman ‚Äì hatchback',
                        modelos: [
                            'MINI Clubman R55 Cooper MT 1600CC 5P',
                            'MINI Clubman R55 Cooper S MT 1600CC 5P T',
                            'MINI Clubman R55 Cooper S JCW MT 1600CC 5P T',
                            'MINI Clubman R55 Cooper S TP 1600CC 5P T',
                            'MINI Clubman F54 Peeper TP 1500CC T 6P',
                            'MINI Clubman F54 Cooper S TP 2000CC T 6P',
                            'MINI Clubman F54 JCW ALL4 TP 2000CC T CT TC 6P'
                        ]
                    },
                    mini_cooper_descapotables: {
                        nombre: 'MINI Cooper ‚Äì descapotables',
                        modelos: [
                            'MINI Cooper R52 Cabriolet MT 1600CC',
                            'MINI Cooper R52 Cabriolet TP 1600CC',
                            'MINI Cooper R57 S Cabriolet MT 1600CC T',
                            'MINI Cooper R57 Cabriolet MT 1600CC',
                            'MINI Cooper R59 S Roadster TP 1600CC T',
                            'MINI Cooper R57 LCI JCW Cabrio Chili TP 1600CC T',
                            'MINI Cooper R52 S Cabriolet MT 1600CC',
                            'MINI Cooper R57 S Cabrio Connected MT 1600CC T',
                            'MINI Cooper R57 S Cabrio Connected TP 1600CC T',
                            'MINI Cooper R59 JCW Roadster MT 1600CC T',
                            'MINI Cooper R57 Cabriolet TP 1600CC',
                            'MINI Cooper F57 S Cabriolet Chili TP 2000CC T',
                            'MINI Cooper F57 Cabriolet Peeper TP 1500CC T',
                            'MINI Cooper F57 JCW Cabriolet Chili TP 2000CC T TC',
                            'MINI Cooper F57 LCI S Cabriolet Iconic TP 2000CC T',
                            'MINI Cooper F57 John Cooper Works Cabrio Spitfire TP 2000CC 6AB 4x2',
                            'MINI Cooper F67 S Cabrio Favoured TP 2000CC T 6AB',
                            'MINI Cooper F67 Cabrio JCW Max TP 2000CC T'
                        ]
                    },
                    mini_cooper_hatchback: {
                        nombre: 'MINI Cooper ‚Äì hatchback',
                        modelos: [
                            'MINI COOPER R50 STD COUPE MT 1600CC',
                            'MINI COOPER R56 S COUPE TP 1600CC 3P T',
                            'MINI COOPER R56 S COUPE MT 1600CC 3P T',
                            'MINI COOPER R56 S COUPE MT 1600CC 3P T TC CT',
                            'MINI COOPER R56 1.6 COUPE MT 1600CC 3P CT',
                            'MINI COOPER R56 JOHN COOPER WORKS COUPE MT 1600CC 3P T TC',
                            'MINI COOPER R56 1.6 COUPE TP 1600CC 3P',
                            'MINI COOPER R56 1.6 COUPE MT 1600CC 3P',
                            'MINI COOPER R56 S COUPE TP 1600CC 3P T TC CT',
                            'MINI COOPER R56 1.6 COUPE TP 1600CC CT',
                            'MINI COOPER R56 LCI CONNECTED MT 1600CC 3P',
                            'MINI COOPER R56 LCI JCW JALAPE√ëO MT 1600CC 3P T TC CT',
                            'MINI COOPER R61 S PACEMAN CONNECTED TP 1600CC 3P T',
                            'MINI COOPER R56 LCI S CONNECTED MT 1600CC 3P T',
                            'MINI COOPER R56 LCI JCW JALAPE√ëO TP 1600CC 3P T TC CT',
                            'MINI COOPER R58 S COUPE TP 1600CC T',
                            'MINI COOPER F56 COUPE PEEPER TP 1500CC T',
                            'MINI COOPER F56 S COUPE TP 2000CC T',
                            'MINI COOPER F56 S COUPE PEEPER TP 2000CC T',
                            'MINI COOPER F56 COUPE SALT MT 1500CC T',
                            'MINI COOPER F56 COUPE SALT TP 1500CC T',
                            'MINI COOPER R56 LCI JCW GP MT 1600CC T',
                            'MINI COOPER F55 PEEPER TP 1500CC T 5P',
                            'MINI COOPER R58 S JCW MT 1600CC T 3P',
                            'MINI COOPER F55 S COOPER CHILI TP 2000CC T 5P',
                            'MINI COOPER F56 JCW TP 2000CC T 3P',
                            'MINI COOPER F55 S COOPER PEEPER TP 2000CC T 5P',
                            'MINI COOPER F55 SALT MT 1500CC T 5P',
                            'MINI COOPER F55 SALT TP 1500CC T 5P',
                            'MINI COOPER F56 S COUPE CHILI MT 2000CC T CT',
                            'MINI COOPER F56 S COUPE CHILI TP 2000CC T CT',
                            'MINI COOPER F56 S COUPE PEEPER MT 2000CC T',
                            'MINI COOPER F56 edicion 60 a√±os aniversario TP 1500CC T TC',
                            'MINI COOPER F56 JCW GP TP 2000CC T TC',
                            'MINI COOPER F55 S COOPER SALT TP 2000CC T 5P',
                            'MINI COOPER F56 LCI SE ICONIC AT CT TC'
                        ]
                    },
                    mini_countryman_hatchback: {
                        nombre: 'MINI Countryman ‚Äì hatchback',
                        modelos: [
                            'MINI COUNTRYMAN R60 COOPER S ALL4 TP 1600CC 6P T',
                            'MINI COUNTRYMAN R60 COOPER S ALL4 1600CC 6P T',
                            'MINI COUNTRYMAN R60 COOPER S CHILI MT 1600CC 6P T',
                            'MINI COUNTRYMAN R60 COOPER CHILI ALL4 TP 1600CC T 6P CT',
                            'MINI COUNTRYMAN R60 COOPER S CHILI ALL4 1600CC 6P',
                            'MINI COUNTRYMAN R60 COOPER S CHILI ALL4 TP 1600CC T 6P T',
                            'MINI COUNTRYMAN R60 COOPER S ALL4 PEEPER TP 1600CC 6P',
                            'MINI COUNTRYMAN F60 COOPER S CHILI TP 2000CC 6P T',
                            'MINI COUNTRYMAN F60 COOPER PEEPER TP 1600CC T 6P',
                            'MINI COUNTRYMAN F60 COOPER S CHILI ALL4 TP 2000CC T CT',
                            'MINI COUNTRYMAN F60 COOPER S E CHILI ALL4 TP 1600CC T 6P CT',
                            'MINI COUNTRYMAN F60 COOPER S E PEEPER ALL4 TP 1600CC T 6P CT',
                            'MINI COUNTRYMAN F60 LCI COOPER S E CLASSIC ALL4 TP 1600CC T 6P',
                            'MINI COUNTRYMAN F60 LCI COOPER S E ICONIC ALL4 TP 1600CC T 6P CT',
                            'MINI COUNTRYMAN F60 LCI COOPER S E CLASSIC TP 2000CC T 6P',
                            'MINI COUNTRYMAN F60 LCI COOPER S ICONIC TP 2000CC T 6P CT',
                            'MINI COUNTRYMAN F60 LCI COOPER S CLASSIC TP 1600CC T 6P',
                            'MINI COUNTRYMAN F60 LCI JCW ALL4 ICONIC TP 2000CC T 6P CT',
                            'MINI COUNTRYMAN F60 LCI COOPER S ALL4 ICONIC TP 2000CC T',
                            'MINI COUNTRYMAN F60 COOPER S E PEEPER ALL4 TP 1600CC 6P PHEV',
                            'MINI COUNTRYMAN U25 CLASSIC AT 1500CC 6P 6AB',
                            'MINI COUNTRYMAN U25 E CLASSIC TP 274KW 6P',
                            'MINI COUNTRYMAN U25 JCW COOPER WORKS MAX TP 2000CC T'
                        ]
                    },
                    mini_countryman_d_hatchback: {
                        nombre: 'MINI Countryman D ‚Äì hatchback',
                        modelos: [
                            'MINI COUNTRYMAN D U25 FAVOURED TP 2000CC TD 5P',
                            'MINI COUNTRYMAN D U25 CLASSIC TP 2000CC TD 5P 6AB'
                        ]
                    },
                    mini_countryman_e_hatchback: {
                        nombre: 'MINI Countryman E ‚Äì hatchback',
                        modelos: [
                            'MINI COUNTRYMAN E U25 FAVOURED AT 152KW 5'
                        ]
                    },
                    mini_minicord_sedan: {
                        nombre: 'MINI Minicord ‚Äì sedan',
                        modelos: [
                            'MINI Mini COOPER COUPE MT 1000CC',
                            'MINI Mini COOPER 1300 COUPE MT 1300CC 2P',
                            'MINI MiniCord JOHN COOPER MT 1000CC AA'
                        ]
                    },
                    minicord_sedan: {
                        nombre: 'Minicord - sedan',
                        modelos: [
                            'MINI MiniCord BX STANDAR MT 1000CC',
                            'MINI MiniCord BA LUJO MT 1000CC AA'
                        ]
                    }
                }
            }
        };

        const clearSelect = (selectElement, placeholderText) => {
            selectElement.innerHTML = '';
            const placeholder = document.createElement('option');
            placeholder.value = '';
            placeholder.disabled = true;
            placeholder.selected = true;
            placeholder.textContent = placeholderText;
            selectElement.appendChild(placeholder);
        };

        const hideElement = element => {
            if (element) {
                element.classList.add('hidden');
            }
        };

        const showElement = element => {
            if (element) {
                element.classList.remove('hidden');
            }
        };

        const populateBrandOptions = () => {
            clearSelect(vehicleBrandSelect, 'Seleccione una marca');
            Object.entries(VEHICLE_CATALOG).forEach(([key, data]) => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = data.nombre;
                option.dataset.label = data.nombre;
                if (data.tipo) {
                    option.dataset.tipo = data.tipo;
                }
                vehicleBrandSelect.appendChild(option);
            });
            const manualOption = document.createElement('option');
            manualOption.value = MANUAL_OPTION_VALUE;
            manualOption.textContent = 'Otra marca / escribir manualmente';
            vehicleBrandSelect.appendChild(manualOption);
        };

        const resetVehicleSelectors = () => {
            vehicleBrandSelect.selectedIndex = 0;
            vehicleBrandSelect.value = '';
            clearSelect(vehicleSeriesSelect, 'Seleccione una serie');
            clearSelect(vehicleModelSelect, 'Seleccione un modelo');
            vehicleSeriesSelect.disabled = true;
            vehicleModelSelect.disabled = true;
            vehicleModelCustomInput.value = '';
            vehicleModelCustomInput.classList.add('hidden');
            vehicleManualInput.value = '';
            hideElement(vehicleSeriesGroup);
            hideElement(vehicleModelGroup);
            hideElement(vehicleManualGroup);
            updateAddButtonState();
        };

        const updateSerieHiddenValue = () => {
            if (!serieVehiculoHiddenInput) {
                return;
            }
            const labels = selectedVehicles.map(item => item.label);
            serieVehiculoHiddenInput.value = labels.join('; ');
        };

        const getCurrentSelection = () => {
            const brandValue = vehicleBrandSelect.value;
            if (!brandValue) {
                return null;
            }

            if (brandValue === MANUAL_OPTION_VALUE) {
                const manualText = vehicleManualInput.value.trim();
                if (!manualText) {
                    return null;
                }
                return {
                    brandValue,
                    brandLabel: 'Entrada manual',
                    serieValue: '',
                    serieLabel: '',
                    modelValue: manualText,
                    modelLabel: manualText,
                    label: manualText
                };
            }

            const catalogEntry = VEHICLE_CATALOG[brandValue];
            if (!catalogEntry) {
                return null;
            }

            const brandOption = vehicleBrandSelect.options[vehicleBrandSelect.selectedIndex];
            const brandLabel = brandOption ? (brandOption.dataset.label || brandOption.textContent.trim()) : catalogEntry.nombre;

            const serieValue = vehicleSeriesSelect.value;
            if (!serieValue) {
                return null;
            }

            const serieOption = vehicleSeriesSelect.options[vehicleSeriesSelect.selectedIndex];
            const serieLabel = serieOption ? (serieOption.dataset.label || serieOption.textContent.trim()) : '';

            const modelGroupVisible = !vehicleModelGroup.classList.contains('hidden');
            let modelValue = '';
            let modelLabel = '';

            if (modelGroupVisible) {
                modelValue = vehicleModelSelect.value;
                if (!modelValue) {
                    return null;
                }

                if (modelValue === OTHER_MODEL_VALUE) {
                    modelLabel = vehicleModelCustomInput.value.trim();
                    if (!modelLabel) {
                        return null;
                    }
                    modelValue = modelLabel;
                } else {
                    const modelOption = vehicleModelSelect.options[vehicleModelSelect.selectedIndex];
                    modelLabel = modelOption ? (modelOption.dataset.label || modelOption.textContent.trim()) : modelValue;
                }
            }

            const labelParts = [brandLabel, serieLabel];
            if (modelLabel) {
                labelParts.push(modelLabel);
            }

            return {
                brandValue,
                brandLabel,
                serieValue,
                serieLabel,
                modelValue,
                modelLabel,
                label: labelParts.join(' | ')
            };
        };

        const updateAddButtonState = () => {
            if (!addVehicleButton) {
                return;
            }
            const canAdd = Boolean(getCurrentSelection());
            addVehicleButton.disabled = !canAdd;
        };

        const renderSelectedVehicles = () => {
            if (!selectedVehiclesContainer) {
                return;
            }

            selectedVehiclesContainer.innerHTML = '';

            if (!selectedVehicles.length) {
                selectedVehiclesContainer.classList.add('empty');
                selectedVehiclesContainer.textContent = 'Sin veh√≠culos seleccionados.';
            } else {
                selectedVehiclesContainer.classList.remove('empty');
                selectedVehicles.forEach((item, index) => {
                    const tagButton = document.createElement('button');
                    tagButton.type = 'button';
                    tagButton.className = 'vehicle-tag';
                    tagButton.textContent = item.label;
                    const removeIcon = document.createElement('span');
                    removeIcon.className = 'vehicle-tag__remove';
                    removeIcon.setAttribute('aria-hidden', 'true');
                    removeIcon.textContent = '√ó';
                    tagButton.appendChild(removeIcon);
                    tagButton.title = 'Click para eliminar';
                    tagButton.setAttribute('aria-label', `Eliminar ${item.label}`);
                    tagButton.addEventListener('click', () => {
                        selectedVehicles.splice(index, 1);
                        renderSelectedVehicles();
                    });
                    selectedVehiclesContainer.appendChild(tagButton);
                });
            }

            updateSerieHiddenValue();
            updateAddButtonState();
        };

        const handleBrandChange = () => {
            clearSelect(vehicleSeriesSelect, 'Seleccione una serie');
            clearSelect(vehicleModelSelect, 'Seleccione un modelo');
            vehicleSeriesSelect.disabled = true;
            vehicleModelSelect.disabled = true;
            vehicleModelCustomInput.value = '';
            vehicleModelCustomInput.classList.add('hidden');
            vehicleManualInput.value = '';
            hideElement(vehicleModelGroup);
            hideElement(vehicleManualGroup);

            const selectedBrand = vehicleBrandSelect.value;

            if (!selectedBrand) {
                hideElement(vehicleSeriesGroup);
                updateSerieHiddenValue();
                updateAddButtonState();
                return;
            }

            if (selectedBrand === MANUAL_OPTION_VALUE) {
                hideElement(vehicleSeriesGroup);
                hideElement(vehicleModelGroup);
                showElement(vehicleManualGroup);
                updateSerieHiddenValue();
                updateAddButtonState();
                vehicleManualInput.focus();
                return;
            }

            const catalogEntry = VEHICLE_CATALOG[selectedBrand];
            if (!catalogEntry) {
                hideElement(vehicleSeriesGroup);
                updateSerieHiddenValue();
                updateAddButtonState();
                return;
            }

            showElement(vehicleSeriesGroup);
            vehicleSeriesSelect.disabled = false;

            Object.entries(catalogEntry.series).forEach(([serieKey, serieData]) => {
                const option = document.createElement('option');
                option.value = serieKey;
                option.textContent = serieData.nombre;
                option.dataset.label = serieData.nombre;
                vehicleSeriesSelect.appendChild(option);
            });

            hideElement(vehicleModelGroup);

            if (catalogEntry.tipo && tipoVehiculoSelect) {
                const normalizedTipo = catalogEntry.tipo.toLowerCase();
                const matchingOption = Array.from(tipoVehiculoSelect.options).find(option => option.value.toLowerCase() === normalizedTipo);
                if (matchingOption) {
                    tipoVehiculoSelect.value = matchingOption.value;
                }
            }

            updateSerieHiddenValue();
            updateAddButtonState();
        };

        const handleSeriesChange = () => {
            clearSelect(vehicleModelSelect, 'Seleccione un modelo');
            vehicleModelSelect.disabled = true;
            vehicleModelCustomInput.value = '';
            vehicleModelCustomInput.classList.add('hidden');
            hideElement(vehicleModelGroup);

            const brandKey = vehicleBrandSelect.value;
            const serieKey = vehicleSeriesSelect.value;
            if (!brandKey || !serieKey || brandKey === MANUAL_OPTION_VALUE) {
                updateSerieHiddenValue();
                updateAddButtonState();
                return;
            }

            const catalogEntry = VEHICLE_CATALOG[brandKey];
            const serieEntry = catalogEntry && catalogEntry.series ? catalogEntry.series[serieKey] : null;
            if (!serieEntry) {
                updateSerieHiddenValue();
                updateAddButtonState();
                return;
            }

            if (serieEntry.modelos && serieEntry.modelos.length) {
                showElement(vehicleModelGroup);
                vehicleModelSelect.disabled = false;
                serieEntry.modelos.forEach(modelo => {
                    const option = document.createElement('option');
                    option.value = modelo;
                    option.textContent = modelo;
                    option.dataset.label = modelo;
                    vehicleModelSelect.appendChild(option);
                });
                const customOption = document.createElement('option');
                customOption.value = OTHER_MODEL_VALUE;
                customOption.textContent = 'Otro modelo / especificar';
                vehicleModelSelect.appendChild(customOption);
            }

            updateSerieHiddenValue();
            updateAddButtonState();
        };

        const handleModelChange = () => {
            if (vehicleModelSelect.value === OTHER_MODEL_VALUE) {
                vehicleModelCustomInput.classList.remove('hidden');
                vehicleModelCustomInput.focus();
            } else {
                vehicleModelCustomInput.classList.add('hidden');
                vehicleModelCustomInput.value = '';
            }
            updateSerieHiddenValue();
            updateAddButtonState();
        };

        const handleAddVehicle = () => {
            const selection = getCurrentSelection();
            if (!selection) {
                return;
            }

            selectedVehicles.push(selection);
            renderSelectedVehicles();
            resetVehicleSelectors();

            if (vehicleBrandSelect) {
                vehicleBrandSelect.focus();
            }
        };

        populateBrandOptions();
        renderSelectedVehicles();
        resetVehicleSelectors();

        vehicleBrandSelect.addEventListener('change', handleBrandChange);
        vehicleSeriesSelect.addEventListener('change', handleSeriesChange);
        vehicleModelSelect.addEventListener('change', handleModelChange);
        vehicleModelCustomInput.addEventListener('input', updateAddButtonState);
        vehicleManualInput.addEventListener('input', updateAddButtonState);
        if (addVehicleButton) {
            addVehicleButton.addEventListener('click', handleAddVehicle);
        }


        const openSuccessModal = () => {
            if (!successModal) {
                alert('‚úÖ Registro enviado correctamente');
                return;
            }

            successModal.classList.add('show');
            successModal.setAttribute('aria-hidden', 'false');
            closeModalButton?.focus();
        };

        const closeSuccessModal = () => {
            if (!successModal) {
                return;
            }

            successModal.classList.remove('show');
            successModal.setAttribute('aria-hidden', 'true');
            submitButton?.focus();
        };

        if (closeModalButton) {
            closeModalButton.addEventListener('click', closeSuccessModal);
        }

        if (successModal) {
            successModal.addEventListener('click', event => {
                if (event.target === successModal) {
                    closeSuccessModal();
                }
            });
        }

        document.addEventListener('keydown', event => {
            if (event.key === 'Escape' && successModal?.classList.contains('show')) {
                closeSuccessModal();
            }
        });

        form.addEventListener('submit', e => {
            e.preventDefault();
            submitButton.disabled = true;
            submitButton.textContent = 'Enviando...';

            updateSerieHiddenValue();

            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => data[key] = value);

            fetch(scriptURL, { 
                method: 'POST', 
                mode: 'no-cors', // <-- El cambio clave est√° aqu√≠
                headers: {
                    'Content-Type': 'text/plain;charset=utf-8',
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                form.reset();
                selectedVehicles = [];
                renderSelectedVehicles();
                resetVehicleSelectors();
                openSuccessModal();
            })
            .catch(error => {
                console.error('Error al enviar el formulario', error);
                alert('‚ùå Error al enviar el registro. Intenta nuevamente.');
            })
            .finally(() => {
                submitButton.disabled = false;
                submitButton.textContent = 'Enviar registro';
            });
        });
    </script>

</body>
</html>
